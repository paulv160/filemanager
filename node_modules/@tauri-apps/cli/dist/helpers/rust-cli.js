import{_ as r,a as t,b as o}from"../tslib.es6-753a81cf.js";import{existsSync as i}from"fs";import{dirname as e,resolve as s,join as a}from"path";import{spawnSync as c,spawn as n}from"./spawn.js";import{downloadCli as m}from"./download-binary.js";import{fileURLToPath as p}from"url";import"cross-spawn";import"../logger-27e93e7d.js";import"chalk";import"ms";import"util";import"stream";import"global-agent";import"module";var u=e(p(import.meta.url));function l(e,p){return r(this,void 0,void 0,(function(){var r,l,f,d,w,b,g,h,v;return t(this,(function(t){switch(t.label){case 0:return r=s(u,"../.."),l=a(r,"bin/tauri-cli"+("win32"===process.platform?".exe":"")),b=new Promise((function(r,t){f=r,d=function(){return t(new Error)}})),g=function(r,t){0===r?f():d()},i(l)?(w=n(l,o(["tauri",e],p),process.cwd(),g),[3,4]):[3,1];case 1:return[4,m()];case 2:return t.sent(),w=n(l,o(["tauri",e],p),process.cwd(),g),[3,4];case 3:i(s(r,"test"))?(h=s(r,"../cli.rs"),c("cargo",["build","--release"],h),v=s(r,"../cli.rs/target/release/cargo-tauri"),w=n(v,o(["tauri",e],p),process.cwd(),g)):(c("cargo",["install","--root",r,"tauri-cli","--version","1.0.0-beta.7"],process.cwd()),w=n(l,o(["tauri",e],p),process.cwd(),g)),t.label=4;case 4:return[2,{pid:w,promise:b}]}}))}))}export{l as runOnRustCli};
